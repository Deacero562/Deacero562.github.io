<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Auto Add Liquidity</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
</head>
<body>
  <button onclick="addLiquidity()">Agregar Liquidez</button>

  <script>
    const CONTRACT_ADDRESS = "0x344ec156133a57169cb50d8f2a67f9e9023698fc";
    const ABI = [ // Solo la parte necesaria del ABI
      {
        "inputs": [
          { "internalType": "address", "name": "tokenA", "type": "address" },
          { "internalType": "address", "name": "tokenB", "type": "address" },
          { "internalType": "uint256", "name": "amountADesired", "type": "uint256" },
          { "internalType": "uint256", "name": "amountBDesired", "type": "uint256" },
          { "internalType": "uint256", "name": "amountAMin", "type": "uint256" },
          { "internalType": "uint256", "name": "amountBMin", "type": "uint256" },
          { "internalType": "address", "name": "to", "type": "address" },
          { "internalType": "uint256", "name": "deadline", "type": "uint256" }
        ],
        "name": "addLiquidity",
        "outputs": [
          { "internalType": "uint256", "name": "amountA", "type": "uint256" },
          { "internalType": "uint256", "name": "amountB", "type": "uint256" },
          { "internalType": "uint256", "name": "liquidity", "type": "uint256" }
        ],
        "stateMutability": "nonpayable",
        "type": "function"
      }
    ];

    const tokenA = "0xa37D029DE7c770ef8DE20fB1225167f84ae9DeC8";
    const tokenB = "0x788839617211f1056Ef48C3B425A102E804A5A36";

    const amountADesired = ethers.utils.parseUnits("10000000", 18);
    const amountBDesired = ethers.utils.parseUnits("10000000", 18);
    const amountAMin = ethers.utils.parseUnits("9900000", 18);
    const amountBMin = ethers.utils.parseUnits("9900000", 18);

    async function addLiquidity() {
      if (!window.ethereum) {
        alert("Instalá MetaMask primero.");
        return;
      }

      await ethereum.request({ method: 'eth_requestAccounts' });
      const provider = new ethers.providers.Web3Provider(window.ethereum);
      const signer = provider.getSigner();
      const address = await signer.getAddress();

      const contract = new ethers.Contract(CONTRACT_ADDRESS, ABI, signer);

      const deadline = Math.floor(Date.now() / 1000) + 1800; // 30 minutos desde ahora

      try {
        const tx = await contract.addLiquidity(
          tokenA,
          tokenB,
          amountADesired,
          amountBDesired,
          amountAMin,
          amountBMin,
          address,
          deadline
        );
        await tx.wait();
        alert("Liquidez agregada exitosamente.");
      } catch (err) {
        console.error("Error al agregar liquidez:", err);
        alert("Error al agregar liquidez. Revisá la consola.");
      }
    }
  </script>
</body>
</html>
